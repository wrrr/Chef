#!/bin/zsh

echo "🔄 Staging local changes..."
git add .
if ! git diff-index --quiet HEAD; then
  git commit -m "Sync with GitHub: sanitize project structure"
fi
git push

echo "📦 Installing dependencies..."
npm install

echo "📦 Building production bundle..."
npm run build

echo "☁️ Deploying to Cloudflare Pages..."
# Clear Wrangler state
rm -rf .wrangler/state

# Deploy using the correct command for Pages
wrangler pages deploy ./build --env-file .env

echo "✅ Deployment complete! Visit your live site."
